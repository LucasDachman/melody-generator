(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{12:function(t,e,n){t.exports=n(19)},17:function(t,e,n){},19:function(t,e,n){"use strict";n.r(e);var a=n(0),o=n.n(a),i=n(11),r=n.n(i),c=(n(17),n(8)),s=n(3),l=n(4),u=n(6),p=n(5),h=n(7),m=n(2),b=n.n(m),f=function(t){function e(){var t,n;Object(s.a)(this,e);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(u.a)(this,(t=Object(p.a)(e)).call.apply(t,[this].concat(o)))).onWheel=function(t,e){var a=n.props,o=a.updateProbability,i=a.steps[e].probability;t.deltaY>0&&i<100?o(e,i+1):t.deltaY<0&&i>1&&o(e,i-1)},n}return Object(h.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t=this,e=this.props,n=e.steps,a=e.isBlack,i=e.onClick,r=this.props.black?"black":"white";return o.a.createElement("section",{className:"key-row ".concat(r)},o.a.createElement("div",{className:"steps-row"},n.map(function(e,n){return o.a.createElement(y,{isBlack:a,isActive:e.isActive,onClick:function(){return i(n)},onWheel:function(e){return t.onWheel(e,n)},probability:e.probability,key:n})})))}}]),e}(o.a.PureComponent),y=function(t){var e=t.isBlack,n=t.isActive,a=t.onClick,i=t.onWheel,r=t.probability,c=["piano-cell",e?"black":"white",n?"active":"inactive"].join(" ");return o.a.createElement("span",{className:c,onClick:a,onWheel:n?i:null},n&&o.a.createElement("p",null,r))},v=f,k=n(1),d=n.n(k);function w(t){return"black"===t.color}var j=function(t){function e(){return Object(s.a)(this,e),Object(u.a)(this,Object(p.a)(e).apply(this,arguments))}return Object(h.a)(e,t),Object(l.a)(e,[{key:"onClickStep",value:function(t,e){}},{key:"render",value:function(){var t=this.props.composition,e=this.props,n=e.notes,a=e.onClickStep,i=e.onClickKey,r=e.updateProbability;return o.a.createElement("div",{className:"piano-roll"},o.a.createElement("section",{className:"piano-roll-keys"},n.map(function(t){var e=["piano-key",w(t)?"black":"white"].join(" ");return o.a.createElement("div",{className:e,onClick:function(){return i(t)},key:t.name},o.a.createElement("p",null,t.name))})),o.a.createElement("section",{className:"piano-roll-editor"},n.map(function(e,n){return o.a.createElement(v,{name:e.name,steps:t[n],black:w(e),onClick:function(t){return a(n,t)},updateProbability:function(t,e){return r(n,t,e)},key:n})})))}}]),e}(o.a.Component),g=function(){function t(){var e=this;Object(s.a)(this,t),this.synth=new d.a.PolySynth(6,d.a.Synth).toMaster(),this.chords=[],this.step=0,this.loop=new d.a.Loop(function(t){var n=e.chanceNote();console.log("next chord:",n),d.a.context.resume(),n&&e.synth.triggerAttackRelease(n,"32n",t)},"16n").start("+0.1"),d.a.Transport.bpm.value=90,d.a.context.latencyHint="playback"}return Object(l.a)(t,[{key:"chanceChord",value:function(){var t=this.chords[this.step]||[];return this.step++,this.step>=this.chords.length&&(this.step=0),t.reduce(function(t,e){return Math.floor(101*Math.random())<=e.probability?[].concat(Object(c.a)(t),[e.note.name]):t},[])}},{key:"chanceNote",value:function(){var t=this.chords[this.step]||[];this.step++,this.step>=this.chords.length&&(this.step=0);var e=b.a.flatMap(t,function(t){return new Array(t.probability).fill(t.note.name)});return console.log(e),e[Math.floor(Math.random()*e.length)]}},{key:"playNote",value:function(t){d.a.context.resume(),this.synth.triggerAttackRelease(t,"4n")}},{key:"setNotes",value:function(t){this.chords=t}},{key:"start",value:function(){d.a.context.resume(),d.a.Transport.start()}},{key:"stop",value:function(){d.a.Transport.stop()}}]),t}(),C=24,E=8,O=36,A=function(t){function e(t){var n;Object(s.a)(this,e),(n=Object(u.a)(this,Object(p.a)(e).call(this,t))).notes=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:127;if(!(t<0||e>127)){var n=new Array(e-t).fill(0).map(function(e,n){return n+t});return n=n.map(function(t){var e=d.a.Frequency(t,"midi").toNote();return{name:e,color:e.includes("#")?"black":"white"}})}console.error("note out of range")}(O,O+C),n.synth=new g,n.toggleCell=function(t,e){n.setState(function(n){var a=b.a.cloneDeep(n.composition),o=a[t][e];return o.isActive=!o.isActive,o.isActive||(o.probability=100),{composition:a}},function(){n.createSequence()})},n.updateProbability=function(t,e,a){n.setState(function(n){var o=b.a.cloneDeep(n.composition);return o[t][e].probability=a,{composition:o}},function(){n.createSequence()})},n.playKey=function(t){n.synth.playNote(t.name)},n.clear=function(){n.setState(function(t){var e=b.a.cloneDeep(t.composition);return e.forEach(function(t){t.forEach(function(t){t.isActive=!1,t.probability=100})}),{composition:e}},function(){n.createSequence()})};var a=new Array(C).fill(null).map(function(t,e){return new Array(E).fill(null).map(function(){return{isActive:!1,note:n.notes[e],probability:100}})});return n.state={composition:a},n}return Object(h.a)(e,t),Object(l.a)(e,[{key:"createSequence",value:function(){var t=b.a.zip.apply(b.a,Object(c.a)(this.state.composition)).map(function(t){return t.reduce(function(t,e){return e.isActive?[].concat(Object(c.a)(t),[b.a.pick(e,["note.name","probability"])]):t},[])});this.synth.setNotes(t)}},{key:"render",value:function(){return o.a.createElement("main",{className:"app"},o.a.createElement("button",{onClick:this.synth.start},"Play"),o.a.createElement("button",{onClick:this.synth.stop},"Stop"),o.a.createElement("button",{onClick:this.clear},"Clear"),o.a.createElement(j,{notes:this.notes,composition:this.state.composition,onClickStep:this.toggleCell,updateProbability:this.updateProbability,onClickKey:this.playKey}))}}]),e}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(A,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[12,1,2]]]);
//# sourceMappingURL=main.da74841a.chunk.js.map